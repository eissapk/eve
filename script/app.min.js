"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition,"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/eve/serviceWorker.js").then(function(e){return console.log("service worker registered")}).catch(function(e){return console.log("service worker not registered",e)})});var MyApp=function(){function M(){_classCallCheck(this,M)}return _createClass(M,null,[{key:"global",value:function(){M.menu=document.querySelector("#settingsMenu li ul"),M.closeBtn=document.querySelector(".xBtn"),M.runBtn=document.getElementById("runBtn"),M.topLid=document.getElementById("topEyeLid"),M.bottomLid=document.getElementById("bottomEyeLid"),M.shutdownArr=["see you tomorrow","don't let the bed bugs bite","sleep well","goodnight"],M.failArr=["sorry, i didn't understand.","sorry, i don't understand.","sorry i didn't understand the question you have been asking","i wasn't able to understand the question i heard","i'm sorry, i didn't get what you said"],M.resText="",M.volume=1,M.rate=.9,M.pitch=.7,M.switchCon=document.querySelector(".generalLayer"),M.voiceCon=document.querySelector(".voiceLayer"),M.timeToggle=!0,M.alarmToggle=!0,M.weatherToggle=!0,M.googleToggle=!0,M.wikiToggle=!0,M.requestToggle=!0,M.closeTabsToggle=!0,M.logOutToggle=!0,M.alarmLoop=!0,M.prayerChecker=!0,M.prayerToggle=!0,M.azanToggle=!1,M.tabs=[],M.unknownQ=[],M.shutdown=!1,M.isListening=!1,M.autoRestart=!0,M.mainToggle=!1}},{key:"showSettings",value:function(e){var t=document.getElementById("settingsPage"),n=document.querySelectorAll(".settingsLayer");"li"===e.target.nodeName.toLowerCase()&&(document.body.style.overflow="hidden",n.forEach(function(e){return e.style.display="none"}),t.style.display="block"),e.target.classList.contains("generalBtn")?document.querySelector(".generalLayer").style.display="block":e.target.classList.contains("voiceBtn")?document.querySelector(".voiceLayer").style.display="block":e.target.classList.contains("helpBtn")&&(document.querySelector(".helpLayer").style.display="block")}},{key:"hideSettings",value:function(e){e.target.classList.contains("closeLayerBtn")&&(document.body.style.overflow="auto",document.getElementById("settingsPage").style.display="none")}},{key:"eyeAnimation",value:function(){M.topLid.className="",M.bottomLid.className="",M.topLid.classList.add("closeTopEyeLid"),M.bottomLid.classList.add("closeBottomEyeLid"),setTimeout(function(){M.topLid.className="",M.bottomLid.className="",M.topLid.classList.add("openTopEyeLid"),M.bottomLid.classList.add("openBottomEyeLid")},200)}},{key:"syncTime",value:function(){var e=new Date,t=e.getHours(),n=[12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11][t],o="";o=12<=t?", PM":", AM";var a=e.getMinutes(),i="";return 1===a?i="and, ".concat(a," minute"):1<a?i="and, ".concat(a," minutes"):0===a&&(i=", sharp"),"it's ".concat(n," ").concat(i," ").concat(o)}},{key:"syncDate",value:function(){var e=new Date,t=e.getMonth(),n=e.getDate();return"it's ".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][t],", ").concat(n)}},{key:"setAlarm",value:function(e,t){M.alarmLoop=!0;var n=(new Date).getTime()+6e4*e;void 0!==M.alarmInterval&&clearInterval(M.alarmInterval),M.wakeUp(n,t)}},{key:"wakeUp",value:function(t,n){M.alarmInterval=setInterval(function(){if(M.alarmLoop){var e=(new Date).getTime();t<=e&&(M.alarmAudio(n),M.alarmLoop=!1)}},1e3)}},{key:"alarmAudio",value:function(e){if("speechSynthesis"in window){var t=window.speechSynthesis,n=new SpeechSynthesisUtterance("wake up, ".concat(e," passed"));n.volume=M.volume,n.rate=M.rate,n.pitch=M.pitch,t.speak(n)}}},{key:"prayerAlarm",value:function(l){var u=document.getElementById("notify"),e=new Date,d=e.getDate(),a=e.getMonth()+1,i=e.getFullYear(),t=function(e){var t=e.coords.latitude,n=e.coords.longitude,o="https://api.aladhan.com/v1/calendar?latitude=".concat(t,"&longitude=").concat(n,"&method=").concat(5,"&month=").concat(a,"&year=").concat(i);fetch(o).then(function(e){return e.json()}).then(function(e){var t=e.data[d-1].timings,n=t.Fajr.replace(/\D/gi,""),o=t.Dhuhr.replace(/\D/gi,""),a=t.Asr.replace(/\D/gi,""),i=t.Maghrib.replace(/\D/gi,""),r=t.Isha.replace(/\D/gi,"");M.prayerArr=[{h:+n.slice(0,2),m:+n.slice(2),prayer:"fajr"},{h:+o.slice(0,2),m:+o.slice(2),prayer:"dhuhr"},{h:+a.slice(0,2),m:+a.slice(2),prayer:"asr"},{h:+i.slice(0,2),m:+i.slice(2),prayer:"maghrib"},{h:+r.slice(0,2),m:+r.slice(2),prayer:"isha"}];function s(){return(new Date).getMinutes()}var c;setInterval(function(){M.prayerChecker&&(console.log("Prayer Checker"),M.prayerArr.forEach(function(e){e.h!=(new Date).getHours()||e.m!=s()&&s()-e.m!=1&&s()-e.m!=2||(c=e.prayer,M.azanToggle=!0,M.prayerChecker=!1)}))},1e3);setInterval(function(){M.azanToggle&&(console.log("Azan Time"),function(){if("speechSynthesis"in window){l.abort(),M.shutdown=!0,M.mainToggle=!1,u.innerHTML="It's ".concat(c," prayer time"),u.style.backgroundColor="#25b869",u.style.display="block",setTimeout(function(){u.style.display="none",u.style.backgroundColor="#d81d2f"},5e3);var e=window.speechSynthesis,t=new SpeechSynthesisUtterance("it's ".concat(c," prayer time"));t.volume=M.volume,t.rate=M.rate,t.pitch=M.pitch,e.speak(t)}setTimeout(function(){new Audio("/eve/sounds/azan.mp3").play(),setTimeout(function(){M.mainToggle=!0,M.runBtn.click()},15e4)},3e3)}(),setTimeout(function(){return M.prayerChecker=!0},18e5),M.azanToggle=!1)},1e3)}).catch(function(e){return console.log("Couldn't Fetch Prayer Time.")})},n=function(e){switch(e.code){case e.PERMISSION_DENIED:u.innerHTML="User denied the request for Geolocation.",u.style.display="block",setTimeout(function(){return u.style.display="none"},5e3);break;case e.POSITION_UNAVAILABLE:u.innerHTML="Location information is unavailable.",u.style.display="block",setTimeout(function(){return u.style.display="none"},5e3);break;case e.TIMEOUT:u.innerHTML="The request to get user location timed out.",u.style.display="block",setTimeout(function(){return u.style.display="none"},5e3);break;case e.UNKNOWN_ERROR:u.innerHTML="An unknown error occurred.",u.style.display="block",setTimeout(function(){return u.style.display="none"},5e3)}};navigator.geolocation&&M.prayerToggle?(navigator.geolocation.getCurrentPosition(t,n),M.prayerToggle=!1):navigator.geolocation||alert("Geolocation is not supported by this browser.")}},{key:"fireAssistant",value:function(){fetch("/eve/data.json").then(function(e){return e.json()}).then(function(e){document.querySelector("video").play(),M.mainToggle=!0,M.handleRecognition(e),M.shutdown=!1;var t=document.getElementById("runBtn"),n=document.getElementById("robotCon"),o=document.querySelectorAll(".eye"),a=document.getElementById("chat"),i=document.querySelector("#chat section");t.style.display="none",n.style.display="block",a.style.marginTop=i?"50px":"0px",o.forEach(function(e){return e.style.filter="grayscale(0)"}),document.getElementById("statusIcon").style.filter="grayscale(0)"}).catch(function(e){return console.log(e)})}},{key:"handleRecognition",value:function(t){var e=document.getElementById("statusIcon"),n=document.querySelector(".mic"),o=document.querySelector(".dots"),a=document.getElementById("notify");if("SpeechRecognition"in window&&"speechSynthesis"in window){var i=new SpeechRecognition;i.lang="en-US",i.maxAlternatives=5;var r=window.speechSynthesis,s=new SpeechSynthesisUtterance;r.getVoices();s.voiceURI="native",s.lang="en-US",s.volume=M.volume,s.rate=M.rate,s.pitch=M.pitch,i.onstart=function(){M.isListening=!0,new Audio("/eve/sounds/bell.mp3").play(),e.classList.remove("active"),n.classList.remove("active"),o.classList.remove("active"),e.classList.add("active"),o.classList.add("active")},i.onend=function(){M.isListening=!1,e.classList.remove("active"),n.classList.remove("active"),o.classList.remove("active"),e.classList.add("active"),n.classList.add("active")},i.onerror=function(e){"not-allowed"!=e.error&&"service-not-allowed"!=e.error||(M.autoRestart=!1,a.innerHTML="Recognition is not allowed! <br> Please refresh the page and enable the mic.",a.style.display="block",setTimeout(function(){return a.style.display="none"},5e3))},i.onresult=function(e){return M.getResults(e,t,r,s,i)},M.prayerAlarm(i),setInterval(function(){if(M.autoRestart&&navigator.onLine&&!M.shutdown)if(M.isListening||r.speaking){if(r.speaking&&M.isListening)console.log("Recognition Aborted"),i.abort();else if(M.isListening&&!r.speaking||r.speaking&&!M.isListening)return void console.log("Return Nothing")}else console.log("Recognition Started"),i.abort(),i.start()},1e3)}else a.innerHTML="Your browser is not supported! <br> It's prefered to use the lastest version of google chrome.",a.style.display="block",setTimeout(function(){return a.style.display="none"},5e3)}},{key:"getResults",value:function(e,t,n,o,a){var i=document.getElementById("statusIcon"),r=document.querySelector(".mic"),s=document.querySelector(".dots"),c=document.getElementById("chat"),l=Array.from(e.results).map(function(e){return e[0]}).map(function(e){return e.transcript}).join("");if(e.results[0].isFinal){M.isListening=!1,i.classList.remove("active"),r.classList.remove("active"),s.classList.remove("active"),i.classList.add("active"),r.classList.add("active"),c.style.marginTop="50px";var u=document.createElement("section");u.innerHTML='\n                        <div class="order">\n                          <div><img src="img/user.svg" alt="user"></div>\n                          <div><span>'.concat(l,'</span></div>\n                        </div>\n                        <div class="clearFix"></div>\n                        '),c.append(u),M.processData(l.toLowerCase(),t,n,o,a,u)}}},{key:"processData",value:function(n,e,s,c,t,l){var u=document.getElementById("chat"),r=document.getElementById("notify"),o=e.orders.filter(function(e){for(var t=0;t<e.keywords.length;t+=1)if(n===e.keywords[t])return e}),a=e.talk.filter(function(e){for(var t=0;t<e.keywords.length;t+=1)if(n.includes(e.keywords[t]))return e});if(/^goodnight|good night/gi.test(n)&&M.logOutToggle)document.querySelector("video").pause(),M.resText=M.shutdownArr[Math.floor(Math.random()*M.shutdownArr.length)],t.abort(),M.topLid.className="",M.bottomLid.className="",document.querySelectorAll(".eye").forEach(function(e){return e.style.filter="grayscale(1)"}),document.getElementById("statusIcon").style.filter="grayscale(1)",setTimeout(function(){document.getElementById("robotCon").style.display="none",document.getElementById("runBtn").style.display="block"},2500),M.shutdown=!0;else if(o.length){var i=o[0].response[0];M.tabs.push(window.open(i,"_blank")),M.resText="done"}else if(a.length)M.resText=a[0].response[Math.floor(Math.random()*a[0].response.length)];else if(!a.length&&!o.length)if(/^search\s+/i.test(n)&&M.googleToggle){var d=n.replace(/^search\s+/i,"");M.tabs.push(window.open("https://www.google.com/search?q=".concat(d),"_blank")),M.resText="here's what i found"}else if(/^request\s+/i.test(n)&&M.requestToggle){var g=n.replace(/^request|\s+/gi,"");M.tabs.push(window.open("http://".concat(g),"_blank")),M.resText="done"}else if(/close all windows/gi.test(n)&&M.closeTabsToggle)M.tabs.forEach(function(e){return e.close()}),M.resText="done";else if(/close last window/gi.test(n)&&M.closeTabsToggle){if(M.tabs.length){var y=M.tabs.length-1;M.tabs[y].close(),M.tabs.splice(y,1)}M.resText="done"}else if(/what time/gi.test(n)&&M.timeToggle)M.resText=M.syncTime();else if(/today's date|today is date/gi.test(n)&&M.timeToggle)M.resText=M.syncDate();else if(/set alarm for\s+|set an alarm for\s+/i.test(n)&&M.alarmToggle){var p=Number(n.replace(/\D/gi,"")),h=0==p?5:p,m="".concat(h,1<h?" minutes":" minute");M.setAlarm(h,m),M.resText="alarm has been set for ".concat(m)}else if(/^define\s+/i.test(n)&&M.wikiToggle){var v=n.replace(/^define\s+/i,"");fetch("https://en.wikipedia.org/w/api.php?action=query&list=search&prop=info&inprop=url&utf8=&format=json&origin=*&srlimit=10&srsearch=".concat(v)).then(function(e){return e.json()}).then(function(e){var t=e.query.search.map(function(e){return"".concat(e.snippet.replace(/<[^>]*>|&nbsp;|&quot;/gi,""))});if(t.length){M.resText=t[Math.floor(Math.random()*t.length)],c.text=M.resText,s.speak(c);var n='\n                      <div class="response">\n                        <div><img src="img/eve.svg" alt="eve"></div>\n                        <div><span>'.concat(M.resText,"</span></div>\n                      </div>\n                      ");l.insertAdjacentHTML("beforeend",n),u.scroll({top:u.scrollHeight,left:0,behavior:"smooth"})}else{M.resText="iam sorry, i didn't find any results!",c.text=M.resText,s.speak(c);var o='\n                      <div class="response">\n                        <div><img src="img/eve.svg" alt="eve"></div>\n                        <div><span>'.concat(M.resText,"</span></div>\n                      </div>\n                      ");l.insertAdjacentHTML("beforeend",o),u.scroll({top:u.scrollHeight,left:0,behavior:"smooth"})}}).catch(function(e){M.resText="failed to fetch wikipedia",c.text=M.resText,s.speak(c);var t='\n                      <div class="response">\n                        <div><img src="img/eve.svg" alt="eve"></div>\n                        <div><span>'.concat(M.resText,"</span></div>\n                      </div>\n                      ");l.insertAdjacentHTML("beforeend",t),u.scroll({top:u.scrollHeight,left:0,behavior:"smooth"})})}else if(/how is the weather|how's the weather|how is weather|how's weather/gi.test(n)&&M.weatherToggle){var f=[48,57,75,51,76,114,85,90,119,10],w=[66,85,119,10,66,84,98,88,104,85],T=[120,88,55,109,50,48,10,65,104,76],b=[10,49,50,105,99,78],k=function(a){return new Promise(function(e,t){var n,o=new Uint8Array(((n=[].concat(f,w,T,b)).forEach(function(e,t,n){10===e&&n.splice(t,1)}),n));e(window.crypto.subtle.encrypt({name:"RSA-OAEP"},a,o))})};window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]).then(function(t){k(t.publicKey).then(function(e){var n,o;n=t.privateKey,o=e,new Promise(function(e,t){e(window.crypto.subtle.decrypt({name:"RSA-OAEP"},n,o))}).then(function(a){var i=new TextDecoder,e=function(e){var t=e.coords.latitude,n=e.coords.longitude,o="https://api.climacell.co/v3/weather/realtime?lat=".concat(t,"&lon=").concat(n,"&unit_system=").concat("si","&fields=temp%2C").concat("humidity","%2C").concat("precipitation_type","%2C").concat("cloud_cover");fetch(o,{method:"GET",headers:{apikey:i.decode(a)}}).then(function(e){return e.json()}).then(function(e){var t=/c/i.test(e.temp.units)?"Celsius":"Fahrenheit",n="".concat(Math.ceil(+e.temp.value)," ").concat(t),o=/none/i.test(e.precipitation_type.value)?"":",there is "+e.precipitation_type.value,a="".concat(Math.ceil(+e.humidity.value),"%"),i=0==e.cloud_cover.value?"":"and the sky is cloudy by "+Math.ceil(+e.cloud_cover.value)+"%";M.resText="according to your location, the temperature is ".concat(n,", ").concat(o," also the humidity is ").concat(a," ").concat(i),c.text=M.resText,s.speak(c);var r='\n                      <div class="response">\n                        <div><img src="img/eve.svg" alt="eve"></div>\n                        <div><span>'.concat(M.resText,"</span></div>\n                      </div>\n                      ");l.insertAdjacentHTML("beforeend",r),u.scroll({top:u.scrollHeight,left:0,behavior:"smooth"})}).catch(function(e){M.resText="failed to fetch the weather",c.text=M.resText,s.speak(c);var t='\n                      <div class="response">\n                        <div><img src="img/eve.svg" alt="eve"></div>\n                        <div><span>'.concat(M.resText,"</span></div>\n                      </div>\n                      ");l.insertAdjacentHTML("beforeend",t),u.scroll({top:u.scrollHeight,left:0,behavior:"smooth"})})},t=function(e){switch(e.code){case e.PERMISSION_DENIED:r.innerHTML="User denied the request for Geolocation.",r.style.display="block",setTimeout(function(){return r.style.display="none"},5e3);break;case e.POSITION_UNAVAILABLE:r.innerHTML="Location information is unavailable.",r.style.display="block",setTimeout(function(){return r.style.display="none"},5e3);break;case e.TIMEOUT:r.innerHTML="The request to get user location timed out.",r.style.display="block",setTimeout(function(){return r.style.display="none"},5e3);break;case e.UNKNOWN_ERROR:r.innerHTML="An unknown error occurred.",r.style.display="block",setTimeout(function(){return r.style.display="none"},5e3)}};navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t):alert("Geolocation is not supported by this browser.")})})})}else{M.resText=M.failArr[Math.floor(Math.random()*M.failArr.length)],null===localStorage.getItem("ai")?M.unknownQ=[]:M.unknownQ=JSON.parse(localStorage.getItem("ai")),M.unknownQ.push(n);var L=_toConsumableArray(new Set(M.unknownQ));localStorage.setItem("ai",JSON.stringify(L))}if(!/^define\s+/i.test(n)&&!/how is the weather|how's the weather|how is weather|how's weather/gi.test(n)){var A=M.resText.replace(/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/gi,"");c.text=A,s.speak(c);var S='\n                      <div class="response">\n                        <div><img src="img/eve.svg" alt="eve"></div>\n                        <div><span>'.concat(M.resText,"</span></div>\n                      </div>\n                      ");l.insertAdjacentHTML("beforeend",S),u.scroll({top:u.scrollHeight,left:0,behavior:"smooth"})}}},{key:"connection",value:function(e){var t=document.getElementById("notify");if("offline"==e.type&&(M.wentOffline=(new Date).getTime(),t.innerHTML="You lost connection.",t.style.display="block"),"online"==e.type){M.wentOnline=(new Date).getTime();var n=Math.round((M.wentOnline-M.wentOffline)/1e3),o=60<=n?"".concat(Math.round(n/60)," minutes!"):"".concat(n," seconds!");t.innerHTML="You are online now <br> Connection lost for ".concat(o),t.style.backgroundColor="#25b869",t.style.display="block",setTimeout(function(){t.style.display="none",t.style.backgroundColor="#d81d2f"},5e3)}}},{key:"handleSwitch",value:function(e){e.target.classList.contains("time-switch")?e.target.checked?M.timeToggle=!0:M.timeToggle=!1:e.target.classList.contains("alarm-switch")?e.target.checked?M.alarmToggle=!0:M.alarmToggle=!1:e.target.classList.contains("weather-switch")?e.target.checked?M.weatherToggle=!0:M.weatherToggle=!1:e.target.classList.contains("google-switch")?e.target.checked?M.googleToggle=!0:M.googleToggle=!1:e.target.classList.contains("wiki-switch")?e.target.checked?M.wikiToggle=!0:M.wikiToggle=!1:e.target.classList.contains("request-switch")?e.target.checked?M.requestToggle=!0:M.requestToggle=!1:e.target.classList.contains("closeTabs-switch")?e.target.checked?M.closeTabsToggle=!0:M.closeTabsToggle=!1:e.target.classList.contains("logOut-switch")&&(e.target.checked?M.logOutToggle=!0:M.logOutToggle=!1)}},{key:"handleVoice",value:function(e){var t=document.getElementById("volumeNum"),n=document.getElementById("rateNum"),o=document.getElementById("pitchNum"),a=document.getElementById("runBtn"),i=+e.target.value;e.target.classList.contains("volumeRange")?(M.volume=i,t.textContent=i,a.click()):e.target.classList.contains("rateRange")?(M.rate=i,n.textContent=i,a.click()):e.target.classList.contains("pitchRange")&&(M.pitch=i,o.textContent=i,a.click())}}]),M}();MyApp.global(),setInterval(function(){MyApp.shutdown||MyApp.eyeAnimation()},6e3),MyApp.menu.addEventListener("click",MyApp.showSettings),MyApp.closeBtn.addEventListener("click",MyApp.hideSettings),MyApp.runBtn.addEventListener("click",MyApp.fireAssistant),MyApp.switchCon.addEventListener("click",MyApp.handleSwitch),window.addEventListener("online",MyApp.connection),window.addEventListener("offline",MyApp.connection),window.addEventListener("blur",function(){MyApp.mainToggle&&window.focus()}),window.addEventListener("focus",function(){MyApp.mainToggle&&(MyApp.autoRestart=!0,MyApp.runBtn.click())});
//# sourceMappingURL=../maps/app.min.js.map
